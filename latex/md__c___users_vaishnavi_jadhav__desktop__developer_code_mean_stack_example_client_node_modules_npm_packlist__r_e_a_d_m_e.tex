\href{https://travis-ci.com/npm/npm-packlist}{\texttt{ }}

Get a list of the files to add from a folder into an npm package.

These can be handed to \href{http://npm.im/tar}{\texttt{ tar}} like so to make an npm package tarball\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const packlist = require('npm-\/packlist')}
\DoxyCodeLine{const tar = require('tar')}
\DoxyCodeLine{const packageDir = '/path/to/package'}
\DoxyCodeLine{const packageTarball = '/path/to/package.tgz'}
\DoxyCodeLine{}
\DoxyCodeLine{packlist(\{ path: packageDir \})}
\DoxyCodeLine{  .then(files => tar.create(\{}
\DoxyCodeLine{    prefix: 'package/',}
\DoxyCodeLine{    cwd: packageDir,}
\DoxyCodeLine{    file: packageTarball,}
\DoxyCodeLine{    gzip: true}
\DoxyCodeLine{  \}, files))}
\DoxyCodeLine{  .then(\_ => \{}
\DoxyCodeLine{    // tarball has been created, continue with your day}
\DoxyCodeLine{  \})}

\end{DoxyCode}


This uses the following rules\+:


\begin{DoxyEnumerate}
\item If a {\ttfamily package.\+json} file is found, and it has a {\ttfamily files} list, then ignore everything that isn\textquotesingle{}t in {\ttfamily files}. Always include the readme, license, notice, changes, changelog, and history files, if they exist, and the package.\+json file itself.
\item If there\textquotesingle{}s no {\ttfamily package.\+json} file (or it has no {\ttfamily files} list), and there is a {\ttfamily .npmignore} file, then ignore all the files in the {\ttfamily .npmignore} file.
\item If there\textquotesingle{}s no {\ttfamily package.\+json} with a {\ttfamily files} list, and there\textquotesingle{}s no {\ttfamily .npmignore} file, but there is a {\ttfamily .gitignore} file, then ignore all the files in the {\ttfamily .gitignore} file.
\item Everything in the root {\ttfamily node\+\_\+modules} is ignored, unless it\textquotesingle{}s a bundled dependency. If it IS a bundled dependency, and it\textquotesingle{}s a symbolic link, then the target of the link is included, not the symlink itself.
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item Unless they\textquotesingle{}re explicitly included (by being in a {\ttfamily files} list, or a {\ttfamily !negated} rule in a relevant {\ttfamily .npmignore} or {\ttfamily .gitignore}), always ignore certain common cruft files\+:
\begin{DoxyEnumerate}
\item .npmignore and .gitignore files (their effect is in the package already, there\textquotesingle{}s no need to include them in the package)
\item editor junk like {\ttfamily .$\ast$.swp}, {\ttfamily .\+\_\+$\ast$} and {\ttfamily .$\ast$.orig} files
\item {\ttfamily .npmrc} files (these may contain private configs)
\item The {\ttfamily node\+\_\+modules/.bin} folder
\item Waf and gyp cruft like {\ttfamily /build/config.gypi} and {\ttfamily .lock-\/wscript}
\item Darwin\textquotesingle{}s {\ttfamily .DS\+\_\+\+Store} files because wtf are those even
\item {\ttfamily npm-\/debug.\+log} files at the root of a project
\end{DoxyEnumerate}

You can explicitly re-\/include any of these with a {\ttfamily files} list in {\ttfamily package.\+json} or a negated ignore file rule.
\end{DoxyEnumerate}

Only the {\ttfamily package.\+json} file in the very root of the project is ever inspected for a {\ttfamily files} list. Below the top level of the root package, {\ttfamily package.\+json} is treated as just another file, and no package-\/specific semantics are applied.\hypertarget{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_npm_packlist__r_e_a_d_m_e_autotoc_md9423}{}\doxysubsection{Interaction between $<$tt$>$package.\+json$<$/tt$>$ and $<$tt$>$.\+npmignore$<$/tt$>$ rules}\label{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_npm_packlist__r_e_a_d_m_e_autotoc_md9423}
For simplicity, it is best to use {\itshape either} a {\ttfamily files} list in {\ttfamily package.\+json} {\itshape or} a {\ttfamily .npmignore} file, and not both. If you only use one of these methods, you can skip this documentation section.

The {\ttfamily files} list in {\ttfamily package.\+json} is used to direct the exploration of the tree. In other words, that\textquotesingle{}s all the walker will ever look at when exploring that level.

In some cases this can lead to a {\ttfamily .npmignore} file being ignored. If a {\itshape directory} is listed in {\ttfamily files}, then any rules in a root or nested {\ttfamily .npmignore} files will be honored.

For example, with this package.\+json\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{  "{}files"{}: [ "{}dir"{} ]}
\DoxyCodeLine{\}}

\end{DoxyCode}


a {\ttfamily .npmignore} file at {\ttfamily dir/.npmignore} (and any subsequent sub-\/directories) will be honored. However, a {\ttfamily .npmignore} at the root level will be skipped.

Conversely, with this package.\+json\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{  "{}files"{}: ["{}dir/subdir"{}]}
\DoxyCodeLine{\}}

\end{DoxyCode}


a {\ttfamily .npmignore} file at {\ttfamily dir/.npmignore} will not be honored.

Any specific file matched by a glob or filename in the package.\+json {\ttfamily files} list will be included, and cannot be excluded by any {\ttfamily .npmignore} files in nested directories, or by a {\ttfamily .npmignore} file in the root package directory, unless that root {\ttfamily .npmignore} file is also in the {\ttfamily files} list.

The previous (v1) implementation used in npm 6 and below treated {\ttfamily package.\+json} as a special sort of \char`\"{}reverse ignore\char`\"{} file. That is, it was parsed and handled as if it was a {\ttfamily .npmignore} file with {\ttfamily !} prepended to all of the globs in the {\ttfamily files} list. In order to include children of a directory listed in {\ttfamily files}, they would {\itshape also} have {\ttfamily /$\ast$$\ast$} appended to them.

This is tricky to explain, but is a significant improvement over the previous (v1) implementation used in npm 6 and below, with the following beneficial properties\+:


\begin{DoxyItemize}
\item If you have {\ttfamily \{\char`\"{}files\char`\"{}\+:\mbox{[}\char`\"{}lib\char`\"{}\mbox{]}\}} in {\ttfamily package.\+json}, then the walker will still ignore files such as {\ttfamily lib/.DS\+\_\+\+Store} and {\ttfamily lib/.foo.\+swp}. The previous implementation would include these files, as they\textquotesingle{}d be matched by the computed {\ttfamily !lib/$\ast$$\ast$} ignore rule.
\item If you have {\ttfamily \{\char`\"{}files\char`\"{}\+:\mbox{[}\char`\"{}lib/a.\+js\char`\"{},\char`\"{}lib/b.\+js\char`\"{}\mbox{]}\}} in {\ttfamily package.\+json}, and a {\ttfamily lib/.npmignore} containing {\ttfamily a.\+js}, then the walker will still include the two files indicated in {\ttfamily package.\+json}, and ignore the {\ttfamily lib/.npmignore} file. The previous implementation would mark these files for inclusion, but then {\itshape exclude} them when it came to the nested {\ttfamily .npmignore} file. (Ignore file semantics dictate that a \char`\"{}closer\char`\"{} ignore file always takes precedence.)
\item A file in {\ttfamily lib/pkg-\/template/package.\+json} will be included, and its {\ttfamily files} list will not have any bearing on other files being included or skipped. When treating {\ttfamily package.\+json} as just Yet Another ignore file, this was not the case, leading to difficulty for modules that aim to initialize a project.
\end{DoxyItemize}

In general, this walk should work as a reasonable developer would expect. Matching human expectation is tricky business, and if you find cases where it violates those expectations, \href{https://github.com/npm/npm-packlist/issues}{\texttt{ please let us know}}.\hypertarget{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_npm_packlist__r_e_a_d_m_e_autotoc_md9424}{}\doxysection{API}\label{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_npm_packlist__r_e_a_d_m_e_autotoc_md9424}
Same API as \href{http://npm.im/ignore-walk}{\texttt{ ignore-\/walk}}, just hard-\/coded file list and rule sets.

The {\ttfamily Walker} and {\ttfamily Walker\+Sync} classes take a {\ttfamily bundled} argument, which is a list of package names to include from node\+\_\+modules. When calling the top-\/level {\ttfamily packlist()} and {\ttfamily packlist.\+sync()} functions, this module calls into {\ttfamily npm-\/bundled} directly. 
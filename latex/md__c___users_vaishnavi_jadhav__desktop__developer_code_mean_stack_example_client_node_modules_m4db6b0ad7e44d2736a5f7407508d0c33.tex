Like \href{http://npm.im/JSONStream}{\texttt{ JSONStream}}, but using Minipass streams\hypertarget{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8784}{}\doxysection{install}\label{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8784}

\begin{DoxyCode}{0}
\DoxyCodeLine{npm install minipass-\/json-\/stream}

\end{DoxyCode}
\hypertarget{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8785}{}\doxysection{example}\label{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8785}

\begin{DoxyCode}{0}
\DoxyCodeLine{const request = require('request')}
\DoxyCodeLine{const JSONStream = require('minipass-\/json-\/stream')}
\DoxyCodeLine{const es = require('event-\/stream')}
\DoxyCodeLine{}
\DoxyCodeLine{request(\{url: 'http://isaacs.couchone.com/registry/\_all\_docs'\})}
\DoxyCodeLine{  .pipe(JSONStream.parse('rows.*'))}
\DoxyCodeLine{  .pipe(es.mapSync(function (data) \{}
\DoxyCodeLine{    console.error(data)}
\DoxyCodeLine{    return data}
\DoxyCodeLine{  \}))}

\end{DoxyCode}
\hypertarget{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8786}{}\doxysection{new JSONStream(options)}\label{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8786}
Create a new stream. This is a \href{http://npm.im/minipass}{\texttt{ minipass}} stream that is always set in {\ttfamily object\+Mode}. It emits objects parsed out of string/buffer JSON input that match the supplied {\ttfamily path} option.\hypertarget{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8787}{}\doxysection{JSONStream.\+parse(path)}\label{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8787}
Return a new JSONStream object to stream values that match a path.

(Equivalent to {\ttfamily new JSONStream(\{path\})}.)


\begin{DoxyCode}{0}
\DoxyCodeLine{JSONStream.parse('rows.*.doc')}

\end{DoxyCode}


The {\ttfamily ..} operator is the recursive descent operator from \href{http://goessner.net/articles/JsonPath/}{\texttt{ JSONPath}}, which will match a child at any depth (see examples below).

If your keys have keys that include {\ttfamily .} or {\ttfamily $\ast$} etc, use an array instead. `\mbox{[}\textquotesingle{}row', true, /$^\wedge$doc/\mbox{]}\`{}.

If you use an array, {\ttfamily Reg\+Exp}s, booleans, and/or functions. The {\ttfamily ..} operator is also available in array representation, using {\ttfamily \{recurse\+: true\}}. any object that matches the path will be emitted as \textquotesingle{}data\textquotesingle{} (and {\ttfamily pipe}d down stream)

If {\ttfamily path} is empty or null, no \textquotesingle{}data\textquotesingle{} events are emitted.

If you want to have keys emitted, you can prefix your {\ttfamily $\ast$} operator with {\ttfamily \$}\+: {\ttfamily obj.\$$\ast$} -\/ in this case the data passed to the stream is an object with a {\ttfamily key} holding the key and a {\ttfamily value} property holding the data.\hypertarget{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8788}{}\doxysubsection{Examples}\label{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8788}
query a couchdb view\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{curl -\/sS localhost:5984/tests/\_all\_docs\&include\_docs=true}

\end{DoxyCode}
 you will get something like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{"{}total\_rows"{}:129,"{}offset"{}:0,"{}rows"{}:[}
\DoxyCodeLine{  \{ "{}id"{}:"{}change1\_0.6995461115147918"{}}
\DoxyCodeLine{  , "{}key"{}:"{}change1\_0.6995461115147918"{}}
\DoxyCodeLine{  , "{}value"{}:\{"{}rev"{}:"{}1-\/e240bae28c7bb3667f02760f6398d508"{}\}}
\DoxyCodeLine{  , "{}doc"{}:\{}
\DoxyCodeLine{      "{}\_id"{}:  "{}change1\_0.6995461115147918"{}}
\DoxyCodeLine{    , "{}\_rev"{}: "{}1-\/e240bae28c7bb3667f02760f6398d508"{},"{}hello"{}:1\}}
\DoxyCodeLine{  \},}
\DoxyCodeLine{  \{ "{}id"{}:"{}change2\_0.6995461115147918"{}}
\DoxyCodeLine{  , "{}key"{}:"{}change2\_0.6995461115147918"{}}
\DoxyCodeLine{  , "{}value"{}:\{"{}rev"{}:"{}1-\/13677d36b98c0c075145bb8975105153"{}\}}
\DoxyCodeLine{  , "{}doc"{}:\{}
\DoxyCodeLine{      "{}\_id"{}:"{}change2\_0.6995461115147918"{}}
\DoxyCodeLine{    , "{}\_rev"{}:"{}1-\/13677d36b98c0c075145bb8975105153"{}}
\DoxyCodeLine{    , "{}hello"{}:2}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \},}
\DoxyCodeLine{]\}}

\end{DoxyCode}


we are probably most interested in the {\ttfamily rows.$\ast$.doc}

create a {\ttfamily JSONStream} that parses the documents from the feed like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{var stream = JSONStream.parse(['rows', true, 'doc']) //rows, ANYTHING, doc}
\DoxyCodeLine{}
\DoxyCodeLine{stream.on('data', function(data) \{}
\DoxyCodeLine{  console.log('received:', data);}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{//emits anything from \_before\_ the first match}
\DoxyCodeLine{stream.on('header', function (data) \{}
\DoxyCodeLine{  console.log('header:', data) // => \{"{}total\_rows"{}:129,"{}offset"{}:0\}}
\DoxyCodeLine{\})}

\end{DoxyCode}


awesome!

In case you wanted the contents the doc emitted\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{// equivalent to: 'rows.*.doc.\$*'}
\DoxyCodeLine{var stream = JSONStream.parse([}
\DoxyCodeLine{  'rows',}
\DoxyCodeLine{  true,}
\DoxyCodeLine{  'doc',}
\DoxyCodeLine{  \{emitKey: true\}}
\DoxyCodeLine{]) //rows, ANYTHING, doc, items in docs with keys}
\DoxyCodeLine{}
\DoxyCodeLine{stream.on('data', function(data) \{}
\DoxyCodeLine{  console.log('key:', data.key);}
\DoxyCodeLine{  console.log('value:', data.value);}
\DoxyCodeLine{\});}

\end{DoxyCode}


You can also emit the path\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{var stream = JSONStream.parse([}
\DoxyCodeLine{  'rows',}
\DoxyCodeLine{  true,}
\DoxyCodeLine{  'doc',}
\DoxyCodeLine{  \{emitPath: true\}}
\DoxyCodeLine{]) //rows, ANYTHING, doc, items in docs with keys}
\DoxyCodeLine{}
\DoxyCodeLine{stream.on('data', function(data) \{}
\DoxyCodeLine{  console.log('path:', data.path);}
\DoxyCodeLine{  console.log('value:', data.value);}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8789}{}\doxysubsection{recursive patterns (..)}\label{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8789}
`JSONStream.\+parse(\textquotesingle{}docs..value'){\ttfamily  (or}JSONStream.\+parse(\mbox{[}\textquotesingle{}docs\textquotesingle{}, \{recurse\+: true\}, \textquotesingle{}value\textquotesingle{}\mbox{]}){\ttfamily using an array) will emit every}value{\ttfamily object that is a child, grand-\/child, etc. of the }docs\`{} object. In this example, it will match exactly 5 times at various depth levels, emitting 0, 1, 2, 3 and 4 as results.


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{  "{}total"{}: 5,}
\DoxyCodeLine{  "{}docs"{}: [}
\DoxyCodeLine{    \{}
\DoxyCodeLine{      "{}key"{}: \{}
\DoxyCodeLine{        "{}value"{}: 0,}
\DoxyCodeLine{        "{}some"{}: "{}property"{}}
\DoxyCodeLine{      \}}
\DoxyCodeLine{    \},}
\DoxyCodeLine{    \{"{}value"{}: 1\},}
\DoxyCodeLine{    \{"{}value"{}: 2\},}
\DoxyCodeLine{    \{"{}blbl"{}: [\{\}, \{"{}a"{}:0, "{}b"{}:1, "{}value"{}:3\}, 10]\},}
\DoxyCodeLine{    \{"{}value"{}: 4\}}
\DoxyCodeLine{  ]}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8790}{}\doxysection{JSONStream.\+parse(pattern, map)}\label{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8790}
(Equivalent to {\ttfamily new JSONStream(\{ pattern, map \})})

provide a function that can be used to map or filter the json output. {\ttfamily map} is passed the value at that node of the pattern, if {\ttfamily map} return non-\/nullish (anything but {\ttfamily null} or {\ttfamily undefined}) that value will be emitted in the stream. If it returns a nullish value, nothing will be emitted.

{\ttfamily JSONStream} also emits `\textquotesingle{}header'{\ttfamily and}\textquotesingle{}footer\textquotesingle{}{\ttfamily events, the}\textquotesingle{}header\textquotesingle{}{\ttfamily event contains anything in the output that was before the first match, and the}\textquotesingle{}footer\textquotesingle{}\`{}, is anything after the last match.\hypertarget{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8791}{}\doxysection{Acknowlegements}\label{md__c___users_vaishnavi_jadhav__desktop__developer_code_mean_stack_example_client_node_modules_m4db6b0ad7e44d2736a5f7407508d0c33_autotoc_md8791}
This module is a fork of \href{http://npm.im/JSONStream}{\texttt{ JSONStream}} by Dominic Tarr, modified and redistributed under the terms of the MIT license.

this module depends on \href{https://github.com/creationix/jsonparse}{\texttt{ https\+://github.\+com/creationix/jsonparse}} by Tim Caswell 